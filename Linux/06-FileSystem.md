# Работа с файловой системой

## pwd - путь до текущей директории

Путь до текущей дериктории

```bash
# pwd - Print Working Directory
pwd
```

## ls - посмотреть содержание папки

Список файлов и директорий:

```bash
# ls - list
ls
# => folder1   folder2   folder3   file.txt
```

Можно вывести не просто набор названий, удобный список с дополнительной информацией:

```bash
ls -l
# => -rw-rw-r-- 1      user             group                150     окт 6 13:13      1.txt
#                  пользователь   группа в которой user    размер      дата         имя файла
#
```

В данном примере:

-   -rw-rw-r-- - смотри [владение файлом](./05-Base.md#владение)
-   1 -
    -   для файла - количество ссылок на файл
    -   для директории - количество папок и файлов на первом уровне ( . и .. тоже считаются)
-   user - смотри [владение файлом](./05-Base.md#владение)
-   group - смотри [владение файлом](./05-Base.md#владение)
-   150 - размер фалйа в байтах
-   окт 6 13:13 - дата последнего редактирования
-   1.txt - имя файла

## cd - переход между директориями

Переход в dir1([что может быть в путях](./05-Base.md#пути)):

```bash
# cd - Change Directory
cd dir1
```

## find - поиск файлов/папок в системе

Поиск в каталоге /home/denis файла file.txt:

```bash
find /home/denis -name "file.txt"
# => /home/denis/file.txt
```

Можно использовать ([регулярки](./05-Base.md#пути)). Например найти все png файлы:

```bash
find /home/denis -name "*.png"
# => /home/denis/src/1.png
# => /home/denis/main.png
```

Примеры:

-   [-i - регистронезависимый поиск](#find---регистронезависимый-поиск)
-   [-type - поиск по типу](#find---поиск-по-типу)
-   [-size - поиск по размеру](#find---поиск-по-размеру)
-   [-cmin - поиск по времени создания/изменения](#find---поиск-по-времени-созданияизменения)
-   [-user/-group/-perm - поиск по правам доступа](#find---поиск-по-правам-доступа)
-   [-and/-or/-not - комбинированные запросы](#find---комбинированные-запросы)
-   [-exec - применить команду к результату](#find---применить-команду-к-результату)

## grep - поиск в фале/файлах

Поиск текста 'search text' в файлах file.txt и file2.txt

```bash
grep 'search text' file.txt file2.txt
```

Поиск текста 'search text' в файлах внутри директории dirpath(только файлы на 1 уровне иерархии):

```bash
grep 'search text' dirpath/*
```

Примеры:

-   [-i - регистронезависимый поиск](#grep---регистронезависимый-поиск)
-   [-w - поиск слова](#grep---поиск-слова)
-   [-c - количество совпадений](#grep---количество-совпадений)
-   [-r - рекурсивный поиск в папках](#grep---рекурсивный-поиск-в-папках)
-   [-m - ограничение на вывод строк](#grep---ограничение-на-вывод-строк)
-   [-C - вывод строк до и после найденного](#grep---вывод-строк-до-и-после-найденного)
-   [-f - несколько шаблонов поиска](#grep---несколько-шаблонов-поиска)

## mkdir - создать директорию

Создать директорию. В /home/denis/ создаст newFolder и newFolder2:

```bash
mkdir /home/denis/newFolder /home/denis/newFolder2
```

Создать папку и полный путь до нее. В /home/denis/ создаст newParentFolder/newFolder:

```bash
mkdir -p /home/denis/newParentFolder/newFolder
```

Примеры:

-   [-v - выводить процесс создание папок](#mkdir---выводить-процесс-создание-папок)
-   [-m - установить права доступа](#mkdir---установить-права-доступа)

## touch - создать файл

Создать пустой файл. В примере создает 3 пустых файла:

```bash
# для существующих папок/файлов обновит дату редактирования. Не затрагивает содержание
touch file1 file2 file3
```

TODO
Для записи смотри [перенаправление вывода]()

## ln - создать ссылку

Создать символическую ссылку - ссылается на файл. Файл можно перемещать и переименовывать, ссылка все равно будет рабочей

```bash
ln -s /home/denis/fileName /home/vasia/linkName
```

Создать жесткую ссылку - точный путь к дириктории или файлу

```bash
ln -P /home/denis/fileName /home/vasia/linkName
```

Создать дубликат - создает полную копию файла, но изменениия отражаются во всех дубликатах. При удаление одного из дубликатов/файла, это не отразится на других дубликатах/файлах

```bash
ln /home/denis/fileName /home/vasia/linkName
```

## mv - перемещение

Переместить файлы(file1, file2) в директорию(/home/vasia):

```bash
mv ./file ./file2 /home/vasia
```

Переместить все .pdf файлы в ~/Documents

```bash
mv *.pdf ~/Documents
```

## mv - переименование

Переименовать файл:

```bash
mv ./oldFileName ./newFileName.txt
```

Переименовать директорию

```bash
mv /home/denis/dir1 /home/denis/dir2
```

## cp - копировнаие

Копируем файлы(file1 и file2) в папку(/home/vasia) и дает имена(file1 и file2):

```bash
cp file1 file2 /home/vasia
```

Все файлы из папки(/home/petia/\*) будут скопированы в папку(/home/vasia):

```bash
cp /home/petia/* /home/vasia
```

Примеры:

-   [-r - копировать папку рекурсивно](#cp---копировать-папку-рекурсивно)
-   [-v - выводить процесс копирования](#cp---выводить-процесс-копирования)

## rm - удалить

Удалить файл:

```bash
rm /home/denis/file.txt
```

Удалить пустую директорию:

```bash
rm -d /home/denis/emptyFolder
```

Удалить файлы и папки рекурсивно

```bash
rm -r dirname
```

## cat/more/less - чтение файла

Отобразить содежимое файла в терминале

```bash
# просто все кинет в терминал
cat <file_path>
```

Просмтреть файл в отдельном подтерминале:

```bash
# просмотр файла
more <file_path>
```

Просмотреть файл в отдельном подтерминале, с возможностью редактировать:

```bash
# просмотр файла
# v - для перехода в редактор nano
# / - для поиска
# n и SHIFT + n - для переходов по результатам поиска
# q - выоход
less <file_path>
```

## wc - получить размеры файла

Получить размеры файлы:

```bash
wc /file.txt
# => 47 1047 7001 file.txt
```

В примере:

-   47 - сколько строчек
-   1047 - сколько слов
-   7001 - сколько символов

# Архивирование

Процес архивирование состоит из 2 подпроцессов:

-   упаковка - сборка папок и файлов в один файл
-   компрессия - уменьшение размеров фала

## tar - упаковка

Упаковка, собираем папку в один файл:

-   tar - команда
-   c - флаг create. То есть создания
-   f - этот флаг всегда должен быть последним
-   newTar.tar - имя упакованного файла
-   folder1 - папка которую упаковываем

```bash
tar cf newTar.tar folder1
```

## tar - распаковка

Распаковываем tar в папку:

-   tar - команда
-   x - флаг extract. То есть распаковка
-   f - этот флаг всегда должен быть последним
-   newTar.tar - имя распаковываемого файла

```bash
tar xf newTar.tar
```

## zip/gzip/bzip2/xz - компрессия

Существует много алгоритмов компрессии. Стандартные:

```bash
# создает newZIP.zip
zip -r newZIP.zip folder1
# создает newTar.tar.gz
gzip newTar.tar
# создает newTar.tar.bz2
bzip2 newTar.tar
# создает newTar.tar.xz
xz newTar.tar
```

## unzip/gunzip/bunzip2/unxz - декомпрессия

Существует много алгоритмов компрессии. Декомпрессия для стандартных:

```bash
unzip newZIP.zip
gunzip newTar.tar.gz
bunzip2 newTar.tar.bz2
unxz newTar.tar.xz
```

## tar - архивирование

Архивирование можно произвести одной командой, без явной упаковки, нужным алгоритмом:

```bash
tar czf newGZIP.gz folder1
tar cjf newBZIP2.bz2 folder1
tar cJf newXZ.xz folder1
```

## tar - разархивирование

Разархивирование можно произвести одной командой, нужным алгоритмом:

```bash
tar xzf newGZIP.gz
tar xjf newBZIP2.bz2
tar xJf newXZ.xz
```

# Примеры

## find - регистронезависимый поиск

Регистронезависимый поиск /home/denis файла file.txt:

```bash
find /home/denis -iname "file.txt"
# => /home/denis/file.txt
# => /home/denis/FILE.txt
# => /home/denis/fILe.txt
```

## find - поиск по типу

Поиск по типу. Могут быть:

-   f – простые файлы
-   d – каталоги
-   l – символические ссылки
-   b – блочные устройства (dev)
-   c – символьные устройства (dev)
-   p – именованные каналы
-   s – сокеты

```bash
find /home/denis -name "img*" -type d
# => /home/denis/img/
# => /home/denis/module/hover/img-hover/
```

## find - поиск по размеру

Поиск по размеру. Размер файла может быть указан:

-   c — Байт
-   k — Кбайт
-   M — Мбайт
-   G — Гбайт

```bash
# найти файлы больше 1Гб
find ./ -size +1G

# найти файлы меньше 1Гб
find ./ -size +1G
```

## find - поиск по времени создания/изменения

Поиск по времени создания/изменения. В примере вернет файлы отредактированные за последние 60 минут:

```bash
find ./ -cmin +60
```

## find - поиск по правам доступа

Поиск по правам доступа:

```bash
# поиск по пользователю
find ./ -user denis

# поиск по группе
find ./ -group adm

# поиск по установленным разрешениям
find ./ -perm 777
```

## find - комбинированные запросы

Комбинированные запросы. Можно использовать такие логические операторы, как:

-   -and
-   -or
-   -not

```bash
find /home \( -user pokeristo -or -user tisha \)  -and  -size +1G
```

## find - применить команду к результату

Применение команды к резултатам поиска:

-   -exec - говорим что тут начинается кманда
-   \; - говоирм что тут заканчивается комнада
-   {} - мето в которое подставляем результаты поиска

```bash
# удалить все пустые файлы в системе
find . -empty -exec rm {} \;

# находит все file.txt
# выводит все найденные файлы
# удаляет все найденные файлы
find ./ -name "file.txt" -exec ls {} \; -exec rm {} \;
```

## grep - регистронезависимый поиск

Флаг регистронезависимого поиска

```bash
grep -i 'search text' dirpath/*
```

## grep - поиск слова

Флаг поиска слова. Проигнорит вот этот текст: "jkfdsearch text jkvm"

```bash
grep -w 'search text' dirpath/*
```

## grep - количество совпадений

Флаг количества совпадений. Выведет число найденных совпдаений

```bash
grep -c 'search text' dirpath/*
```

## grep - рекурсивный поиск в папках

Флаг рекурсивного поиска. Ищет вообще во всех файлах в папке dirpath

```bash
grep -r 'search text' dirpath/*
```

## grep - ограничение на вывод строк

Флаг ограниченного вывода по числу строк

```bash
grep -m10 'search text' dirpath/*
```

## grep - вывод строк до и после найденного

Вывод дополнительной строки A(после), B(до) и C(до и после)

```bash
grep -C1 'search text' dirpath/*
```

## grep - несколько шаблонов поиска

Использовать несколько шаблонов из файла pattern_file. Шаблон должны быть записан с новой строки

```bash
grep -f pattern_file dirpath/*
```

## mkdir - выводить процесс создание папок

Выводить процесс создания папок

```bash
mkdir -v /home/denis/newFolder /home/denis/newFolder2
# => Создан /home/denis/newFolder
# => Создан /home/denis/newFolder2
```

## mkdir - установить права доступа

Устанавливает всем папкам права. Синтаксис как у chmod:

```bash
mkdir -m=777 /home/denis/newFolder /home/denis/newFolder2
```

## cp - выводить процесс копирования

Выводить процесс копирования:

```bash
cp -v /home/petia/* /home/vasia
```

# cp - копировать папку рекурсивно

Копировать папку рекурсивно:

```bash
cp -r /home/vasia /home/denis
```
